<app-card-grid
  [items]="applications"
  [loading]="loading"
  [error]="error"
  [enableFilters]="true"
  [filterFn]="filterApp"
  [getItemId]="getAppId"
  [enableGrouping]="true"
  [getItemTags]="getAppTags"
  [trackByFn]="trackByApp"
  theme="blue"
  loadingText="Loading applications ...">

  <ng-template #cardTemplate let-app>
    <div class="card-header">
      @if (app.iconContent) {
        <div class="icon-wrapper">
          <img [src]="'data:' + (app.iconType || 'image/png') + ';base64,' + app.iconContent" [alt]="app.name + ' Icon'" />
        </div>
      }
      <div class="header-info">
        <h2>{{ app.name }}</h2>
        @if (app.description) {
          <p class="app-description">{{ app.description }}</p>
        }
      </div>
      <span class="source-badge" [class.source-local]="app.source === 'local'" [attr.data-tooltip]="app.source === 'local' ? 'Local' : 'Repository'">
        {{ app.source === 'local' ? 'üìÅ' : 'üì¶' }}
      </span>
    </div>

    @if (app.tags?.length || showFramework) {
      <div class="tags-row">
        @for (tag of app.tags; track tag) {
          <span class="tag-badge">{{ tag }}</span>
        }
        @if (showFramework && app.framework) {
          <span class="framework-badge">{{ app.framework }}</span>
        }
      </div>
    }

    @if (app.errors) {
      <button type="button" class="show-errors-btn" (click)="showErrors(app)">
        <span class="error-x">&#10006;</span>
        Show errors
      </button>
    }

    <div class="card-actions">
      <button type="button" (click)="openProxmoxConfigDialog(app)" [disabled]="(app.errors?.length ?? 0) > 0">Install</button>
    </div>
  </ng-template>
</app-card-grid>
