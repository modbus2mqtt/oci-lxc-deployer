<!-- Step 3: Parameters -->
 <div class="create-application-container">
  <h1>{{ editMode() ? 'Edit Application' : 'Create Application from Framework' }}</h1>
  @if (loadingEditData()) {
    <p>Loading application data...</p>
  }
  <mat-stepper #stepper linear (selectionChange)="onStepChange($event)">
    <!-- Step 1: Select Framework -->
    <mat-step [editable]="true">
      <ng-template matStepLabel>Select Framework</ng-template>
      <app-framework-step
        (frameworkSelected)="onFrameworkSelected($event)"
        (installModeChanged)="onInstallModeChanged($event)"
        (composeFileSelected)="onComposeFileSelected($event)"
        (envFileSelected)="onEnvFileSelected($event)"
        (serviceSelected)="onServiceSelected($event)"
        (imageReferenceChanged)="onImageReferenceChange($event)"
        (annotationsReceived)="onAnnotationsReceived($event)"
      ></app-framework-step>
      <div class="step-actions">
        <button mat-button (click)="cancel()">Cancel</button>
        <button mat-raised-button color="primary" matStepperNext>Next</button>
      </div>
    </mat-step>

    <!-- Step 2: Application Properties -->
    <mat-step [stepControl]="appPropertiesForm" [editable]="true">
      <ng-template matStepLabel>Application Properties</ng-template>
      <app-properties-step></app-properties-step>
      <div class="step-actions">
        <button mat-button matStepperPrevious>Back</button>
        <button mat-raised-button color="primary" matStepperNext>Next</button>
      </div>
    </mat-step>

    <!-- Step 3/4: Parameters -->
    <mat-step [stepControl]="parameterForm" [editable]="true">
      <ng-template matStepLabel>Configure Parameters</ng-template>
      <app-parameters-step></app-parameters-step>
      <div class="step-actions">
        <button mat-button matStepperPrevious>Back</button>
        <button mat-button (click)="cancel()">Cancel</button>
        <button mat-raised-button color="primary" matStepperNext>Next</button>
      </div>
    </mat-step>

    <!-- Step 4: Summary -->
    <mat-step label="Summary">
      <app-summary-step
        (navigateToStep)="onNavigateToStep($event)"
      ></app-summary-step>
      <div class="step-actions">
        <button mat-button matStepperPrevious>Back</button>
        <button mat-raised-button color="primary" (click)="createApplication()" [disabled]="creating()">
          @if (creating()) {
            {{ editMode() ? 'Updating...' : 'Creating...' }}
          } @else {
            {{ editMode() ? 'Update Application' : 'Create Application' }}
          }
        </button>
      </div>
    </mat-step>
  </mat-stepper>
</div>

