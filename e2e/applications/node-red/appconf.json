{
    "name": "node-red",
    "description": "Node-RED is a flow-based programming tool for wiring together hardware devices, APIs and online services.",
    "tags": ["api", "iot"],
    "uploadfiles": [
        { "destination": "data:settings.js", "required": true, "file": "settings.js" },
        { "destination": "certs:server.crt", "required": true, "file": "../../certs/server.crt" },
        { "destination": "certs:server.key", "required": true, "file": "../../certs/server.key" }
    ],
    "installParams": {
        "bridge": "vmbr1"
    },
    "validation": {
        "waitBeforeValidation": 10,
        "commands": [
            {
                "command": "awk '$2 ~ /:0758$/ && $4 == \"0A\" {print $8}' /proc/net/tcp | head -1",
                "expectedOutput": "1000",
                "description": "Process on port 1880 should run as UID 1000"
            },
            {
                "command": "curl -kf https://localhost:1880/",
                "expectedExitCode": 0,
                "description": "Node-RED HTTPS endpoint should respond"
            }
        ]
    }
}
